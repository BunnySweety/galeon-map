"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9486],{79486:(e,t,r)=>{r.r(t),r.d(t,{default:()=>E});var n=r(95155),o=r(12115),l=r(65528),a=r(12669),s=r(13568);let i=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],c=(()=>{if("undefined"==typeof document)return!1;let e=i[0],t={};for(let r of i)if(r?.[1]in document){for(let[n,o]of r.entries())t[e[n]]=o;return t}return!1})(),u={change:c.fullscreenchange,error:c.fullscreenerror},d={request:(e=document.documentElement,t)=>new Promise((r,n)=>{let o=()=>{d.off("change",o),r()};d.on("change",o);let l=e[c.requestFullscreen](t);l instanceof Promise&&l.then(o).catch(n)}),exit:()=>new Promise((e,t)=>{if(!d.isFullscreen)return void e();let r=()=>{d.off("change",r),e()};d.on("change",r);let n=document[c.exitFullscreen]();n instanceof Promise&&n.then(r).catch(t)}),toggle:(e,t)=>d.isFullscreen?d.exit():d.request(e,t),onchange(e){d.on("change",e)},onerror(e){d.on("error",e)},on(e,t){let r=u[e];r&&document.addEventListener(r,t,!1)},off(e,t){let r=u[e];r&&document.removeEventListener(r,t,!1)},raw:c};Object.defineProperties(d,{isFullscreen:{get:()=>!!document[c.fullscreenElement]},element:{enumerable:!0,get:()=>document[c.fullscreenElement]??void 0},isEnabled:{enumerable:!0,get:()=>!!document[c.fullscreenEnabled]}}),c||(d={isEnabled:!1});let p=d;var m=r(6684),h=r(58236),f=r(66313),g=r(66766);function x(e){let{hospital:t,isOpen:r,onClose:a,className:s=""}=e,{i18n:i}=(0,l.b)(),c=(0,o.useCallback)(e=>{try{return(null==i?void 0:i._)?i._(e):e}catch(t){return e}},[i]),u=(0,o.useCallback)((e,t)=>{(t.velocity.y>500||t.offset.y>50)&&a()},[a]),d=(0,o.useCallback)(e=>{"Escape"===e.key&&a()},[a]);return((0,o.useEffect)(()=>(r?(document.addEventListener("keydown",d),document.body.style.overflow="hidden"):(document.removeEventListener("keydown",d),document.body.style.overflow="unset"),()=>{document.removeEventListener("keydown",d),document.body.style.overflow="unset"}),[r,d]),t)?(0,n.jsx)(f.a,{children:r&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(f.b.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm hospital-modal-backdrop",onClick:a,style:{zIndex:1e3}}),(0,n.jsx)(f.b.div,{initial:{y:"100%",opacity:0,scale:.95},animate:{y:0,opacity:1,scale:1},exit:{y:"100%",opacity:0,scale:.95},transition:{type:"spring",damping:30,stiffness:400},className:"hospital-modal-content ".concat(s),drag:"y",dragConstraints:{top:0},dragElastic:{top:0,bottom:.8},onDragEnd:u,style:{zIndex:1001},children:(0,n.jsxs)("div",{className:"hospital-modal-container",children:[(0,n.jsx)("div",{className:"hospital-modal-handle",children:(0,n.jsx)("div",{className:"hospital-modal-handle-bar"})}),(0,n.jsxs)("div",{className:"hospital-modal-scroll-content",children:[(0,n.jsxs)("div",{className:"hospital-modal-header",children:[(0,n.jsxs)("div",{className:"hospital-modal-title-row",children:[(0,n.jsx)("h2",{className:"hospital-modal-title",children:t.name}),(0,n.jsx)("span",{className:"hospital-modal-status ".concat("Deployed"===t.status?"hospital-modal-status-deployed":"hospital-modal-status-signed"),children:c(t.status)})]}),(0,n.jsx)("p",{className:"hospital-modal-address",children:t.address})]}),t.imageUrl&&(0,n.jsx)("div",{className:"hospital-modal-image mobile-modal-image",children:(0,n.jsx)(g.default,{src:t.imageUrl,alt:t.name,fill:!0,className:"object-cover"})}),(0,n.jsx)("div",{className:"hospital-modal-details",children:(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"hospital-modal-label",children:c("Deployment Date")}),(0,n.jsx)("p",{className:"hospital-modal-value",children:new Date(t.deploymentDate).toLocaleDateString(i.locale||"fr",{year:"numeric",month:"long",day:"numeric"})})]})}),(0,n.jsxs)("div",{className:"hospital-modal-actions mobile-modal-actions",children:[(0,n.jsx)("button",{onClick:()=>window.open("https://maps.google.com/?q=".concat(t.coordinates.join(",")),"_blank"),className:"hospital-modal-action-primary",children:(0,n.jsxs)("div",{className:"hospital-modal-action-content",children:[(0,n.jsx)("svg",{className:"hospital-modal-action-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"})}),(0,n.jsx)("span",{children:c("Navigate")})]})}),(0,n.jsx)("button",{onClick:()=>window.open(t.website,"_blank"),className:"hospital-modal-action-secondary",children:(0,n.jsxs)("div",{className:"hospital-modal-action-content",children:[(0,n.jsx)("svg",{className:"hospital-modal-action-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})}),(0,n.jsx)("span",{children:c("Website")})]})})]}),(0,n.jsx)("button",{onClick:a,className:"hospital-modal-close-button","aria-label":c("Close"),children:(0,n.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]})]})})]})}):null}function b(e){let{hospital:t,className:r=""}=e,{i18n:a}=(0,l.b)(),s=(0,o.useCallback)(e=>{try{return(null==a?void 0:a._)?a._(e):e}catch(t){return e}},[a]);return(0,n.jsxs)("div",{className:"hospital-popup-container ".concat(r),children:[(0,n.jsxs)("div",{className:"hospital-popup-header",children:[(0,n.jsxs)("div",{className:"hospital-popup-title-row",children:[(0,n.jsx)("h2",{className:"hospital-popup-title",children:t.name}),(0,n.jsx)("span",{className:"hospital-popup-status ".concat("Deployed"===t.status?"hospital-popup-status-deployed":"hospital-popup-status-signed"),children:s(t.status)})]}),(0,n.jsx)("p",{className:"hospital-popup-address",children:t.address})]}),t.imageUrl&&(0,n.jsx)("div",{className:"hospital-popup-image",children:(0,n.jsx)(g.default,{src:t.imageUrl,alt:t.name,fill:!0,className:"object-cover",sizes:"300px"})}),(0,n.jsx)("div",{className:"hospital-popup-details",children:(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"hospital-popup-label",children:s("Deployment Date")}),(0,n.jsx)("p",{className:"hospital-popup-value",children:new Date(t.deploymentDate).toLocaleDateString(a.locale||"fr",{year:"numeric",month:"long",day:"numeric"})})]})}),(0,n.jsxs)("div",{className:"hospital-popup-actions",children:[(0,n.jsx)("button",{onClick:()=>window.open("https://maps.google.com/?q=".concat(t.coordinates.join(",")),"_blank"),className:"hospital-popup-action-primary",children:(0,n.jsxs)("div",{className:"hospital-popup-action-content",children:[(0,n.jsx)("svg",{className:"hospital-popup-action-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"})}),(0,n.jsx)("span",{children:s("Navigate")})]})}),(0,n.jsx)("button",{onClick:()=>window.open(t.website,"_blank"),className:"hospital-popup-action-secondary",children:(0,n.jsxs)("div",{className:"hospital-popup-action-content",children:[(0,n.jsx)("svg",{className:"hospital-popup-action-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})}),(0,n.jsx)("span",{children:s("Website")})]})})]})]})}let v=!1,y=e=>{let{isLocating:t=!1}=e;return(0,n.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,n.jsx)("circle",{cx:"12",cy:"12",r:"8",stroke:"#A1CBF9",strokeWidth:"2",className:t?"animate-pulse":""}),(0,n.jsx)("circle",{cx:"12",cy:"12",r:"3",fill:"#A1CBF9",className:t?"animate-ping":""}),(0,n.jsx)("path",{d:"M12 2V4",stroke:"#A1CBF9",strokeWidth:"2",strokeLinecap:"round"}),(0,n.jsx)("path",{d:"M12 20V22",stroke:"#A1CBF9",strokeWidth:"2",strokeLinecap:"round"}),(0,n.jsx)("path",{d:"M2 12L4 12",stroke:"#A1CBF9",strokeWidth:"2",strokeLinecap:"round"}),(0,n.jsx)("path",{d:"M20 12L22 12",stroke:"#A1CBF9",strokeWidth:"2",strokeLinecap:"round"})]})},w=()=>(0,n.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"#A1CBF9",strokeWidth:"2",children:[(0,n.jsx)("path",{d:"M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"}),(0,n.jsx)("circle",{cx:"12",cy:"12",r:"1",fill:"#A1CBF9"})]}),k=()=>(0,n.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"#A1CBF9",strokeWidth:"2",children:[(0,n.jsx)("path",{d:"M3 8V5a2 2 0 0 1 2-2h3M16 3v3a2 2 0 0 0 2 2h3M21 16v3a2 2 0 0 1-2 2h-3M8 21v-3a2 2 0 0 0-2-2H3"}),(0,n.jsx)("rect",{x:"10",y:"10",width:"4",height:"4",fill:"#A1CBF9"})]}),j=e=>{let{isFullscreen:t}=e;return t?(0,n.jsx)(k,{}):(0,n.jsx)(w,{})},E=e=>{let{className:t="",filteredHospitals:i}=e,{i18n:c}=(0,l.b)(),[u,d]=(0,o.useState)(!1),{isOpen:f,selectedHospital:g,openModal:w,closeModal:k}=function(){let[e,t]=(0,o.useState)(!1),[r,n]=(0,o.useState)(null);return{isOpen:e,selectedHospital:r,openModal:(0,o.useCallback)(e=>{n(e),t(!0)},[]),closeModal:(0,o.useCallback)(()=>{t(!1),setTimeout(()=>{n(null)},200)},[])}}(),[E,N]=(0,o.useState)(!1),[C,L]=(0,o.useState)(!1),[F,M]=(0,o.useState)(!1),{mapboxgl:T,isLoading:S,error:D}=function(){let[e,t]=(0,o.useState)(null),[n,l]=(0,o.useState)(!0),[a,s]=(0,o.useState)(null);return(0,o.useEffect)(()=>{let e=!0;return(async()=>{try{l(!0),s(null);let n=await r.e(240).then(r.t.bind(r,85411,23));if(!e)return;if("undefined"!=typeof document&&!document.querySelector('link[href*="mapbox-gl.css"]')){let e=document.createElement("link");e.rel="stylesheet",e.href="https://api.mapbox.com/mapbox-gl-js/v3.10.0/mapbox-gl.css",document.head.appendChild(e)}let o=n.default;o.accessToken="pk.eyJ1IjoiamVhbmJvbjkxIiwiYSI6ImNtNDlhMHMzNTA3YnkycXM2dmYxc281MHkifQ.taYYM3jxELZ5CZuOH9_3SQ",e&&(t(o),l(!1))}catch(t){h.a.error("Failed to load mapbox-gl:",t),e&&(s(t instanceof Error?t.message:"Failed to load mapbox-gl"),l(!1))}})(),()=>{e=!1}},[]),{mapboxgl:e,isLoading:n,error:a}}(),A=(0,o.useCallback)(e=>{try{if(!(null==c?void 0:c._))return e;return c._(e)}catch(t){return h.a.error("Error translating text in Map component: ".concat(e),t),e}},[c]),z=(0,o.useRef)(null),R=(0,o.useRef)(null),P=(0,o.useRef)(null),I=(0,o.useRef)({}),B=(0,o.useRef)(null),_=(0,o.useRef)(null),W=(0,o.useRef)(null),Z=(0,o.useRef)(null),O=(0,o.useRef)(!1),U=(0,o.useRef)(!0),[q,H]=(0,o.useState)(!1),V=(0,o.useRef)(null),{hospitals:Y,filteredHospitals:G,currentDate:J,selectHospital:Q,selectedFilters:X,timelineIndex:K,timelineLength:$}=(0,m.a)(),ee=void 0!==i?i:G,et=(0,o.useRef)(!1);(0,o.useEffect)(()=>{},[]),(0,o.useEffect)(()=>(d("ontouchstart"in window||navigator.maxTouchPoints>0),window.addEventListener("touchstart",()=>d(!0),{once:!0}),()=>{window.removeEventListener("touchstart",()=>d(!0))}),[]);let er=(0,o.useCallback)(e=>{if(!P.current||!T)return null;B.current&&(B.current.remove(),B.current=null);let t=document.createElement("div");t.className="location-marker",t.style.width="40px",t.style.height="40px",t.style.position="relative",t.style.zIndex="10";let r=document.createElement("div");r.className="pulse-ring pulse-ring-1",r.style.position="absolute",r.style.width="100%",r.style.height="100%",r.style.borderRadius="50%",r.style.backgroundColor="rgba(66, 133, 244, 0.2)",r.style.border="2px solid rgba(66, 133, 244, 0.6)",r.style.opacity="1";let n=document.createElement("div");n.className="pulse-ring pulse-ring-2",n.style.position="absolute",n.style.width="100%",n.style.height="100%",n.style.borderRadius="50%",n.style.backgroundColor="rgba(66, 133, 244, 0.2)",n.style.border="2px solid rgba(66, 133, 244, 0.6)",n.style.opacity="1";let o=document.createElement("div");o.className="center-dot",o.style.position="absolute",o.style.top="50%",o.style.left="50%",o.style.transform="translate(-50%, -50%)",o.style.width="16px",o.style.height="16px",o.style.borderRadius="50%",o.style.backgroundColor="#4285F4",o.style.border="2px solid white",o.style.boxShadow="0 0 5px rgba(0, 0, 0, 0.3)",o.style.zIndex="2";let l=document.createElement("style");l.textContent="\n      @keyframes radarPulse {\n        0% {\n          transform: scale(0.5);\n          opacity: 1;\n        }\n        50% {\n          transform: scale(1.8);\n          opacity: 0.6;\n        }\n        100% {\n          transform: scale(3);\n          opacity: 0;\n        }\n      }\n      .pulse-ring-1 {\n        animation: radarPulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;\n      }\n      .pulse-ring-2 {\n        animation: radarPulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;\n        animation-delay: 1s;\n      }\n      .location-marker {\n        filter: drop-shadow(0 0 8px rgba(66, 133, 244, 0.6));\n      }\n    ",document.head.appendChild(l),t.appendChild(r),t.appendChild(n),t.appendChild(o);let a=new T.Marker({element:t,anchor:"center"}).setLngLat(e).addTo(P.current);return B.current=a,_.current&&clearTimeout(_.current),_.current=setTimeout(()=>{B.current&&(B.current.remove(),B.current=null),O.current=!1,s.a.success(A("Location marker automatically removed"),{duration:2e3,position:"bottom-center"})},1e4),a},[A,T]);(0,o.useEffect)(()=>{let e=()=>{P.current&&P.current.zoomIn()},t=()=>{P.current&&P.current.zoomOut()},r=e=>{P.current&&e.detail&&(P.current.flyTo({center:[e.detail.lng,e.detail.lat],zoom:12,duration:1500}),er([e.detail.lng,e.detail.lat]))};return window.addEventListener("mapZoomIn",e),window.addEventListener("mapZoomOut",t),window.addEventListener("mapCenterUser",r),()=>{window.removeEventListener("mapZoomIn",e),window.removeEventListener("mapZoomOut",t),window.removeEventListener("mapCenterUser",r)}},[er]);let en=(0,o.useMemo)(()=>e=>()=>{let t=[2.3522,48.8566];if(er(t),P.current){let e=P.current.getZoom();P.current.flyTo({center:t,zoom:e,speed:1.2,curve:1.42,essential:!0})}s.a.dismiss(e),s.a.success("Using test location: Paris, France",{duration:3e3,position:"bottom-center"})},[er]),eo=(0,o.useCallback)(()=>{if(P.current&&T){if(F){M(!1),O.current=!1,W.current&&(clearTimeout(W.current),W.current=null),Z.current&&(s.a.dismiss(Z.current),Z.current=null),s.a.success(A("Geolocation cancelled"),{duration:2e3,position:"bottom-center"});return}if(B.current){O.current=!1,B.current.remove(),B.current=null,_.current&&(clearTimeout(_.current),_.current=null),s.a.success(A("Location marker removed"),{duration:2e3,position:"bottom-center"});return}B.current&&(B.current.remove(),B.current=null),_.current&&(clearTimeout(_.current),_.current=null),O.current=!0,M(!0),Z.current=s.a.loading(A("Locating... Click again to cancel"),{duration:15e3,position:"bottom-center",style:{background:"#333",color:"#fff",border:"1px solid #555"}}),W.current=setTimeout(()=>{M(!1),O.current=!1,Z.current&&(s.a.dismiss(Z.current),Z.current=null),s.a.error(A("Geolocation timed out. Please try again."),{duration:4e3,position:"bottom-center"})},15e3),(window.location.hostname.includes("cloudflare")||window.location.hostname.includes("galeon.community"))&&(0,s.a)(A("Note: Precise geolocation may be limited on this platform. Using approximate location."),{duration:4e3,position:"bottom-center",style:{background:"#333",color:"#fff",border:"1px solid #555"}});try{if(!navigator.geolocation){let e=A("Geolocation is not supported by your browser");s.a.error(e,{duration:4e3,position:"bottom-center",style:{background:"#333",color:"#fff",border:"1px solid #555"}}),O.current=!1;return}"permissions"in navigator&&navigator.permissions.query({name:"geolocation"}).then(e=>{if("denied"===e.state){let e=A("Location access was denied. Please check your browser permissions.");s.a.error(e,{duration:4e3,position:"bottom-center",style:{background:"#333",color:"#fff",border:"1px solid #555"}}),O.current=!1;return}}).catch(()=>{}),navigator.geolocation.getCurrentPosition(e=>{if(M(!1),Z.current&&(s.a.dismiss(Z.current),Z.current=null),W.current&&(clearTimeout(W.current),W.current=null),!P.current||!O.current)return;let{longitude:t,latitude:r}=e.coords;er([t,r]);let n=P.current.getZoom();P.current.flyTo({center:[t,r],zoom:n,speed:1.2,curve:1.42,essential:!0}),s.a.success(A("Location found!"),{duration:3e3,position:"bottom-center"})},e=>{var t;O.current=!1,M(!1),Z.current&&(s.a.dismiss(Z.current),Z.current=null),W.current&&(clearTimeout(W.current),W.current=null);let r=A("Unable to get your location");switch(e.code){case e.PERMISSION_DENIED:r=A("Location access was denied. Please check your browser permissions.");break;case e.POSITION_UNAVAILABLE:r=A("Location information is unavailable. This often happens on localhost. Try using HTTPS or a different network.");break;case e.TIMEOUT:r=A("The request to get your location timed out.")}h.a.warn("Geolocation error (".concat(e.code,"): ").concat(null!=(t=e.message)?t:"No message")),e.code,e.POSITION_UNAVAILABLE,s.a.error(r,{duration:4e3,position:"bottom-center",style:{background:"#333",color:"#fff",border:"1px solid #555"}})},{enableHighAccuracy:!1,timeout:15e3,maximumAge:3e5})}catch(t){h.a.error("Geolocation try-catch error:",t),O.current=!1,M(!1),Z.current&&(s.a.dismiss(Z.current),Z.current=null),W.current&&(clearTimeout(W.current),W.current=null);let e=A("Error accessing geolocation. Please try again.");s.a.error(e,{duration:4e3,position:"bottom-center",style:{background:"#333",color:"#fff",border:"1px solid #555"}})}}},[er,A,F,en,T]),el=(0,o.useCallback)(()=>{p.isEnabled&&R.current&&p.toggle(R.current)},[]);return((0,o.useEffect)(()=>{let e=()=>{p.isEnabled&&N(p.isFullscreen)};return p.isEnabled?(N(p.isFullscreen),p.on("change",e),()=>{p.off("change",e)}):()=>{}},[]),(0,o.useEffect)(()=>{if(!z.current||P.current||et.current||!T)return()=>{};for(et.current=!0;z.current.firstChild;)z.current.removeChild(z.current.firstChild);try{v||(T.setRTLTextPlugin("https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js",null,!0),v=!0);let e=new T.Map({container:z.current,style:"mapbox://styles/mapbox/dark-v11",center:[2.213749,46.5],zoom:4.8,attributionControl:!1,touchZoomRotate:!0,dragRotate:!0,touchPitch:!0,interactive:!0,preserveDrawingBuffer:!0,antialias:!0,minZoom:4,maxZoom:10,fadeDuration:0,trackResize:!0,refreshExpiredTiles:!0,renderWorldCopies:!1});return e.once("load",()=>{e.setTerrain&&"function"==typeof e.setTerrain&&e.setTerrain(null),e.setFog&&"function"==typeof e.setFog&&e.setFog(null);let t=e.getStyle();(null==t?void 0:t.layers)&&t.layers.forEach(t=>{if(t.id.includes("hillshade")||"hillshade"===t.type)try{e.removeLayer(t.id)}catch(e){}});let r=console.error;console.error=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let o=t.join(" ");"string"==typeof o&&o.includes("Canvas2D")&&o.includes("fingerprinting")||t[0]&&"string"==typeof t[0]&&t[0].includes("hook.js:608")||r.apply(console,t)},e.scrollZoom.disable();let n=e.getContainer(),o=t=>{t.preventDefault(),t.stopPropagation();let r=-(.0025*t.deltaY),o=e.getZoom(),l=o+r;if((l=Math.max(e.getMinZoom(),Math.min(e.getMaxZoom(),l)))!==o){let r=n.getBoundingClientRect(),o=[t.clientX-r.left,t.clientY-r.top],a=e.unproject(o);e.easeTo({zoom:l,center:a,duration:0,around:a})}};n.addEventListener("wheel",o,{passive:!1}),e.once("remove",()=>{n.removeEventListener("wheel",o)}),u&&(n.style.touchAction="manipulation",e.touchZoomRotate.enable(),e.touchZoomRotate.disableRotation(),e.setMaxZoom(e.getMaxZoom()),e.dragRotate.disable(),e.touchPitch.disable()),function(){let e=EventTarget.prototype.addEventListener;window._originalAddEventListener=e,EventTarget.prototype.addEventListener=function(t,r,n){if(["mousewheel"].includes(t)){let o={..."object"==typeof n?n:void 0===n?{}:{capture:n},passive:!0};return e.call(this,t,r,o)}return this instanceof HTMLElement&&this.classList&&(this.classList.contains("mapboxgl-canvas")||this.classList.contains("mapboxgl-map")||this.classList.contains("mapboxgl-marker")||this.classList.contains("mapboxgl-popup"))&&["touchstart","touchmove","touchend","wheel"].includes(t),e.call(this,t,r,n)}}(),P.current=e;try{P.current.addSource("hospitals",{type:"geojson",data:{type:"FeatureCollection",features:[]}}),P.current.addLayer({id:"hospital-points",type:"circle",source:"hospitals",paint:{"circle-radius":["case",["boolean",["get","isActive"],!1],9,6],"circle-color":["match",["get","status"],"Deployed","#42A5F5","Signed","#4CAF50","#cccccc"],"circle-stroke-width":["case",["boolean",["get","isActive"],!1],2.5,1.5],"circle-stroke-color":["case",["boolean",["get","isActive"],!1],"#ffffff","#ffffff"]}}),P.current.on("mouseenter","hospital-points",()=>{P.current&&(P.current.getCanvas().style.cursor="pointer")}),P.current.on("mouseleave","hospital-points",()=>{P.current&&(P.current.getCanvas().style.cursor="")})}catch(e){h.a.error("Error initializing map layers:",e)}H(!0)}),()=>{!function(){let e=window,t=e._originalAddEventListener;t&&(EventTarget.prototype.addEventListener=t,delete e._originalAddEventListener)}(),Object.values(I.current).forEach(e=>e.remove()),I.current={},B.current&&(B.current.remove(),B.current=null),_.current&&(clearTimeout(_.current),_.current=null),W.current&&(clearTimeout(W.current),W.current=null),Z.current&&(s.a.dismiss(Z.current),Z.current=null),V.current&&(V.current.remove(),V.current=null),P.current&&(P.current.remove(),P.current=null),et.current=!1,O.current=!1,U.current=!0}}catch(e){return h.a.error("Error initializing map:",e),et.current=!1,()=>{}}},[u,T]),(0,o.useEffect)(()=>{if(!P.current||!ee||!q)return;let e=P.current.getSource("hospitals");if(e)try{let t=ee.filter(e=>"Deployed"===e.status&&!!X.deployed||"Signed"===e.status&&!!X.signed),r=[...window.innerWidth<=768?t:t.filter(e=>{try{let t=new Date(J);t.setUTCHours(0,0,0,0);let r=new Date(e.deploymentDate);return r.setUTCHours(0,0,0,0),r<=t}catch(t){return h.a.error("Error parsing date during map update for hospital ".concat(e.id,":"),t),!1}})].sort((e,t)=>"Deployed"===e.status&&"Deployed"!==t.status?1:"Deployed"!==e.status&&"Deployed"===t.status?-1:0).map(e=>{var t;return{type:"Feature",geometry:{type:"Point",coordinates:null!=(t=e.coordinates)?t:[0,0]},properties:{id:e.id,name:e.name,status:e.status,isActive:e.deploymentDate===J&&K<$-1}}});e.setData({type:"FeatureCollection",features:r})}catch(e){h.a.error("Error updating hospitals source data:",e)}},[Y,J,X,q,K,$]),(0,o.useEffect)(()=>{if(!P.current||!q)return;let e=e=>{var t;if(!(null==(t=e.features)?void 0:t.length)||!P.current)return;let r=e.features[0];if(!r)return;let o=r.geometry.coordinates.slice(),s=window.innerWidth<768||"ontouchstart"in window&&768>=Math.min(window.screen.width,window.screen.height),i=(s?Y:ee).find(e=>{var t;return e.id===(null==(t=r.properties)?void 0:t.id)});if(i)if(s)Q(null),setTimeout(()=>{Q(i)},0);else{V.current&&(V.current.remove(),V.current=null);let e=document.createElement("div");(0,a.createRoot)(e).render((0,n.jsx)(l.a,{i18n:c,children:(0,n.jsx)(b,{hospital:i})}));let t=new T.Popup({closeButton:!1,closeOnClick:!0,maxWidth:"320px",className:"hospital-popup-modern",offset:[0,-10]}).setLngLat(o).setDOMContent(e).addTo(P.current);V.current=t,Q(i),t.on("close",()=>{V.current=null,Q(null)})}};return P.current.on("click","hospital-points",e),()=>{P.current&&P.current.off("click","hospital-points",e)}},[q,ee,Y,Q,c,X,J,K,$]),(0,o.useEffect)(()=>{if(!P.current||!ee||!q)return;let e=P.current.getSource("hospitals");if(e)try{let t=ee.map(e=>{var t;return{type:"Feature",geometry:{type:"Point",coordinates:null!=(t=e.coordinates)?t:[0,0]},properties:{id:e.id,name:e.name,status:e.status,isActive:e.deploymentDate===J&&K<$-1}}});e.setData({type:"FeatureCollection",features:t})}catch(e){console.error("❌ Failed to update markers:",e)}},[ee,q,J,K,$]),(0,o.useEffect)(()=>{let e=()=>{L(window.innerWidth<768)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),S)?(0,n.jsx)("div",{className:"relative w-full h-screen bg-slate-900 flex flex-col ".concat(t),children:(0,n.jsx)("div",{className:"flex-grow flex items-center justify-center",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-blue-500 mx-auto mb-4"}),(0,n.jsx)("h2",{className:"text-xl font-semibold text-white mb-2",children:"Loading Map"}),(0,n.jsx)("p",{className:"text-gray-300",children:"Initializing Mapbox..."})]})})}):D?(0,n.jsx)("div",{className:"relative w-full h-screen bg-slate-900 flex flex-col ".concat(t),children:(0,n.jsx)("div",{className:"flex-grow flex items-center justify-center",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"text-red-500 mb-4",children:"⚠️"}),(0,n.jsx)("h2",{className:"text-xl font-semibold text-white mb-2",children:"Map Loading Failed"}),(0,n.jsx)("p",{className:"text-gray-300",children:D}),(0,n.jsx)("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Retry"})]})})}):(0,n.jsxs)("div",{ref:R,className:"relative w-full h-full bg-slate-900 flex flex-col",children:[(0,n.jsxs)("div",{className:"relative flex-grow",children:[(0,n.jsx)("div",{ref:z,className:"w-full h-full ".concat(t),style:{position:"relative",height:"100%"},"data-testid":"map-container"}),(0,n.jsxs)("div",{className:"absolute map-controls-right ".concat(E?"z-[9999]":"z-[60]"," flex flex-col ").concat((()=>{let e=window.innerWidth<768||"ontouchstart"in window&&768>=Math.min(window.screen.width,window.screen.height);return E?e?"top-4":"top-24":e?"top-16":"top-44"})()),style:{gap:"4px"},children:[(0,n.jsx)("button",{onClick:eo,className:"map-control-button glass-container rounded-2xl touch-manipulation hover:bg-white/20 transition-colors",style:{width:"clamp(45px, 5vw, 55px)",height:"clamp(45px, 5vw, 55px)",padding:"calc(var(--standard-spacing) * 0.4)",cursor:"pointer",margin:"calc(var(--standard-spacing) * 0.4) 0",display:"flex",alignItems:"center",justifyContent:"center",color:"white",touchAction:"manipulation"},"aria-label":"Show my location",title:F?A("Click to cancel"):A("Geolocate"),children:(0,n.jsx)(y,{isLocating:F})}),p.isEnabled&&(0,n.jsx)("button",{onClick:el,className:"map-control-button glass-container rounded-2xl touch-manipulation hover:bg-white/20 transition-colors",style:{width:"clamp(45px, 5vw, 55px)",height:"clamp(45px, 5vw, 55px)",padding:"calc(var(--standard-spacing) * 0.4)",cursor:"pointer",margin:"calc(var(--standard-spacing) * 0.4) 0",display:"flex",alignItems:"center",justifyContent:"center",color:"white",touchAction:"manipulation"},"aria-label":E?A("Exit fullscreen"):A("Enter fullscreen"),title:E?A("Exit fullscreen"):A("Enter fullscreen"),children:(0,n.jsx)(j,{isFullscreen:E})},"fullscreen-".concat(E))]})]})," ",(0,n.jsx)(x,{hospital:g,isOpen:f&&u,onClose:()=>{k(),Q(null)},className:"block md:hidden"})]})}}}]);