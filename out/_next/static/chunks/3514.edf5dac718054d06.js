"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3514],{63514:(t,e,l)=>{l.d(e,{a:()=>h});var n=l(91540),a=l(87820),o=l(58236);let s=async()=>{let[t,e]=await Promise.all([Promise.all([l.e(3930),l.e(913)]).then(l.bind(l,26597)),l.e(6118).then(l.bind(l,76118))]);return{jsPDF:t.default,autoTable:e.autoTable}},i=async()=>await Promise.all([l.e(3524),l.e(8436)]).then(l.bind(l,3925)),r=(t,e)=>"fr"===e?t.nameFr:t.nameEn,d=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"en";try{let l=new Date(t);return(0,a.c)(l,"fr"===e?"d MMMM yyyy":"MMMM d, yyyy",e)}catch(e){return t}},c=async function(t,e,l){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;try{let a=await new Promise((t,e)=>{let l=new Image;l.crossOrigin="anonymous",l.onload=()=>{let n=document.createElement("canvas"),a=n.getContext("2d");if(!a)return void e(Error("Could not get canvas context"));let o=200,s=173;n.width=4*o,n.height=4*s,a.imageSmoothingEnabled=!1,a.drawImage(l,0,0,4*o,4*s);let i=document.createElement("canvas"),r=i.getContext("2d");if(!r)return void e(Error("Could not get final canvas context"));i.width=o,i.height=s,r.imageSmoothingEnabled=!0,r.imageSmoothingQuality="high",r.drawImage(n,0,0,4*o,4*s,0,0,o,s),t(i.toDataURL("image/png",1))},l.onerror=e,l.src="/logo-white.png"});t.addImage(a,"PNG",e,l,22*n,19*n,void 0,"NONE")}catch(p){o.a.warn("Could not load PNG logo, using high-quality vector fallback"),t.setFillColor(255,255,255),t.setDrawColor(255,255,255),t.setLineWidth(.3*n);let a=22*n,s=19*n,i=e+a/2,r=l+s/2,d=.35*s,c=.15*Math.PI,g=(.85*Math.PI-c)/20;t.setLineWidth(1.5*n);for(let e=0;e<20;e++){let l=c+e*g,n=c+(e+1)*g,a=i+Math.cos(l)*d,o=r+Math.sin(l)*d,s=i+Math.cos(n)*d,u=r+Math.sin(n)*d;t.line(a,o,s,u)}t.setFillColor(255,255,255);let u=.12*a,h=.3*s;t.roundedRect(e+.2*a,l+.7*s,u,h,1,1,"F"),t.roundedRect(e+.68*a,l+.7*s,u,h,1,1,"F")}},g=async t=>{let{hospitals:e,locale:l}=t,{jsPDF:n,autoTable:a}=await s(),o=new n("landscape");o.setFont("times");let i=o.internal.pageSize.width,g=o.internal.pageSize.height;o.setFillColor(235,244,253),o.rect(0,0,i,g,"F");let u=g/595.28*103.93;o.setFillColor(71,154,243),o.rect(0,0,i,u,"F"),o.setTextColor(245,251,255),o.setFontSize(24),o.setFont("times","normal");let h=.6*u,p=h-19*.8/2-2;await c(o,20,p,.8);let y="GALEON ",m="fr"===l?"CARTE DES H\xd4PITAUX":"HOSPITALS MAP";o.setTextColor(245,251,255),o.text(y,45,h);let f=45+o.getTextWidth(y);o.setTextColor(100,200,255);for(let t=0;t<3;t++){let e=(t+1)*.3;o.text(m,f+e,h+e),o.text(m,f-e,h+e),o.text(m,f+e,h-e),o.text(m,f-e,h-e)}o.setTextColor(200,240,255),o.text(m,f,h),o.setTextColor(255,255,255),o.text(m,f,h);let S=d(new Date().toISOString(),l);o.setFontSize(12),o.setFont("times","bold");let w=o.getTextWidth(S);o.text(S,i-w-30,.6*u),a(o,{head:[["fr"===l?"NOM":"NAME","fr"===l?"STATUT":"STATUS","fr"===l?"DATE DE D\xc9PLOIEMENT":"DEPLOYMENT DATE","fr"===l?"SITE WEB":"WEBSITE"]],body:e.map(t=>{var e;return[r(t,l),"fr"===l?"Deployed"===t.status?"D\xe9ploy\xe9":"Signed"===t.status?"Sign\xe9":t.status:t.status,t.deploymentDate?d(t.deploymentDate,l):"",null!=(e=t.website)?e:""]}),startY:u+5,styles:{fontSize:10,cellPadding:6,overflow:"linebreak",cellWidth:"wrap",textColor:[13,15,32],fontStyle:"normal",font:"times"},headStyles:{fillColor:[235,244,253],textColor:[13,15,32],fontStyle:"bold",fontSize:12,halign:"center",valign:"bottom",font:"times"},bodyStyles:{fillColor:[235,244,253],valign:"middle",halign:"center"},alternateRowStyles:{fillColor:[218,235,253]},columnStyles:{0:{cellWidth:.3*i,halign:"center"},1:{cellWidth:.12*i,halign:"center"},2:{cellWidth:.28*i,halign:"center"},3:{cellWidth:.3*i,halign:"center"}},margin:{left:0,right:0},tableWidth:"auto",theme:"plain",showHead:"everyPage"});let D=o.internal.getNumberOfPages();for(let t=1;t<=D;t++){o.setPage(t),o.setFontSize(12),o.setTextColor(13,15,32),o.setFont("times","normal");let e=t.toString(),l=o.getTextWidth(e);o.text(e,(i-l)/2,.95*g)}let b="fr"===l?"galeon-hopitaux":"galeon-hospitals",x="".concat(b,"-").concat(new Date().toISOString().split("T")[0],".pdf");o.save(x)},u=async t=>{var e,l,a,o,s,c,g,u,h,p,y,m,f,S,w,D,b;let{hospitals:x,locale:T,translations:E}=t,C=await i(),v=[[null!=(e=E["Hospital Name"])?e:"Hospital Name",null!=(l=E.Status)?l:"Status",null!=(a=E.Address)?a:"Address",null!=(o=E["Deployment Date"])?o:"Deployment Date",null!=(s=E.Website)?s:"Website",null!=(c=E.Coordinates)?c:"Coordinates"],...x.map(t=>{var e,l;return[r(t,T),"fr"===T?"Deployed"===t.status?"D\xe9ploy\xe9":"Signed"===t.status?"Sign\xe9":t.status:t.status,null!=(e=t.address)?e:"",t.deploymentDate?d(t.deploymentDate,T):"",null!=(l=t.website)?l:"",t.coordinates?"".concat(t.coordinates[1],", ").concat(t.coordinates[0]):""]})],F=C.utils.book_new(),M=C.utils.aoa_to_sheet(v);M["!cols"]=[{wch:30},{wch:15},{wch:40},{wch:18},{wch:25},{wch:20}];let P=C.utils.decode_range(null!=(g=M["!ref"])?g:"A1:F1");for(let t=P.s.c;t<=P.e.c;t++){let e=C.utils.encode_cell({r:0,c:t});M[e]&&(M[e].s={font:{bold:!0,color:{rgb:"FFFFFF"}},fill:{fgColor:{rgb:"479AF3"}},alignment:{horizontal:"center"}})}let I=null!=(u=E.Hospitals)?u:"Hospitals";C.utils.book_append_sheet(F,M,I);let H=[[null!=(h=E["Export Information"])?h:"Export Information",""],[null!=(p=E["Export Date"])?p:"Export Date",d(new Date().toISOString(),T)],[null!=(y=E["Total Hospitals"])?y:"Total Hospitals",x.length.toString()],[null!=(m=E["Deployed Hospitals"])?m:"Deployed Hospitals",x.filter(t=>"Deployed"===t.status).length.toString()],[null!=(f=E["Signed Hospitals"])?f:"Signed Hospitals",x.filter(t=>"Signed"===t.status).length.toString()],["",""],[null!=(S=E["Status Distribution"])?S:"Status Distribution",""],[null!=(w=E.Deployed)?w:"Deployed",x.filter(t=>"Deployed"===t.status).length.toString()],[null!=(D=E.Signed)?D:"Signed",x.filter(t=>"Signed"===t.status).length.toString()]],A=C.utils.aoa_to_sheet(H);A["!cols"]=[{wch:25},{wch:15}];let O=null!=(b=E.Metadata)?b:"Metadata";C.utils.book_append_sheet(F,A,O);let N="fr"===T?"galeon-hopitaux":"galeon-hospitals",W="".concat(N,"-").concat(new Date().toISOString().split("T")[0],".xlsx"),_=new Blob([C.write(F,{bookType:"xlsx",type:"array"})],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});(0,n.saveAs)(_,W)},h=async(t,e,l,a,o,s)=>{let i={hospitals:t.filter(t=>{if(!("Deployed"===t.status&&l.deployed||"Signed"===t.status&&l.signed))return!1;try{let l=new Date(e);l.setUTCHours(0,0,0,0);let n=new Date(t.deploymentDate);return n.setUTCHours(0,0,0,0),n<=l}catch(t){return!1}}),locale:a,translations:o};switch(s){case"pdf":await g(i);break;case"xls":await u(i);break;case"json":(t=>{let{hospitals:e,locale:l}=t,a=new Blob([JSON.stringify({metadata:{exportDate:new Date().toISOString(),totalHospitals:e.length,deployedHospitals:e.filter(t=>"Deployed"===t.status).length,signedHospitals:e.filter(t=>"Signed"===t.status).length,locale:l,version:"1.0"},hospitals:e.map(t=>({id:t.id,name:r(t,l),nameFr:t.nameFr,nameEn:t.nameEn,status:"fr"===l?"Deployed"===t.status?"D\xe9ploy\xe9":"Signed"===t.status?"Sign\xe9":t.status:t.status,address:t.address,deploymentDate:t.deploymentDate,website:t.website,coordinates:t.coordinates,exportedAt:new Date().toISOString()}))},null,2)],{type:"application/json"}),o="fr"===l?"galeon-hopitaux":"galeon-hospitals",s="".concat(o,"-").concat(new Date().toISOString().split("T")[0],".json");(0,n.saveAs)(a,s)})(i)}}},87820:(t,e,l)=>{l.d(e,{a:()=>r,b:()=>d,c:()=>i});var n=l(35912),a=l(59273),o=l(13124);let s={en:a.a,fr:o.a};function i(t,e){let l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"en",a="string"==typeof t||"number"==typeof t?new Date(t):t;return(0,n.a)(a,e,{locale:s[l]})}function r(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"en";return i(t,"dd/MM/yyyy",e)}function d(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"en";return i(t,"PPP",e)}}}]);